{
  "swagger": "2.0",
  "info": {
    "title": "flyteidl/service/cache.proto",
    "version": "version not set"
  },
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/v1/cache/executions/{workflow_execution_id.project}/{workflow_execution_id.domain}/{workflow_execution_id.name}": {
      "delete": {
        "summary": "Evicts all cached data for the referenced :ref:`ref_flyteidl.admin.Execution`.",
        "operationId": "EvictExecutionCache",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/serviceEvictCacheResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "workflow_execution_id.project",
            "description": "Name of the project the resource belongs to.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "workflow_execution_id.domain",
            "description": "Name of the domain the resource belongs to.\nA domain can be considered as a subset within a specific project.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "workflow_execution_id.name",
            "description": "User or system provided value for the resource.",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "CacheService"
        ]
      }
    },
    "/api/v1/cache/task_executions/{task_execution_id.node_execution_id.execution_id.project}/{task_execution_id.node_execution_id.execution_id.domain}/{task_execution_id.node_execution_id.execution_id.name}/{task_execution_id.node_execution_id.node_id}/{task_execution_id.task_id.project}/{task_execution_id.task_id.domain}/{task_execution_id.task_id.name}/{task_execution_id.task_id.version}/{task_execution_id.retry_attempt}": {
      "delete": {
        "summary": "Evicts all cached data for the referenced :ref:`ref_flyteidl.admin.TaskExecution`.",
        "operationId": "EvictTaskExecutionCache",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/serviceEvictCacheResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "task_execution_id.node_execution_id.execution_id.project",
            "description": "Name of the project the resource belongs to.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.node_execution_id.execution_id.domain",
            "description": "Name of the domain the resource belongs to.\nA domain can be considered as a subset within a specific project.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.node_execution_id.execution_id.name",
            "description": "User or system provided value for the resource.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.node_execution_id.node_id",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.task_id.project",
            "description": "Name of the project the resource belongs to.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.task_id.domain",
            "description": "Name of the domain the resource belongs to.\nA domain can be considered as a subset within a specific project.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.task_id.name",
            "description": "User provided value for the resource.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.task_id.version",
            "description": "Specific version of the resource.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "task_execution_id.retry_attempt",
            "in": "path",
            "required": true,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "task_execution_id.task_id.resource_type",
            "description": "Identifies the specific type of resource that this identifier corresponds to.\n\n - DATASET: A dataset represents an entity modeled in Flyte DataCatalog. A Dataset is also a versioned entity and can be a compilation of multiple individual objects.\nEventually all Catalog objects should be modeled similar to Flyte Objects. The Dataset entities makes it possible for the UI  and CLI to act on the objects \nin a similar manner to other Flyte objects",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "UNSPECIFIED",
              "TASK",
              "WORKFLOW",
              "LAUNCH_PLAN",
              "DATASET"
            ],
            "default": "UNSPECIFIED"
          }
        ],
        "tags": [
          "CacheService"
        ]
      }
    }
  },
  "definitions": {
    "CacheEvictionErrorCode": {
      "type": "string",
      "enum": [
        "INTERNAL",
        "RESERVATION_NOT_ACQUIRED",
        "DATABASE_UPDATE_FAILED",
        "ARTIFACT_DELETE_FAILED",
        "RESERVATION_NOT_RELEASED"
      ],
      "default": "INTERNAL",
      "description": "Defines codes for distinguishing between errors encountered during cache eviction.\n\n - INTERNAL: Indicates a generic internal error occurred.\n - RESERVATION_NOT_ACQUIRED: Indicates no reservation could be acquired before deleting an artifact.\n - DATABASE_UPDATE_FAILED: Indicates updating the database entry related to the node execution failed.\n - ARTIFACT_DELETE_FAILED: Indicates deleting the artifact from datacatalog failed.\n - RESERVATION_NOT_RELEASED: Indicates the reservation previously acquired could not be released for an artifact."
    },
    "coreCacheEvictionError": {
      "type": "object",
      "properties": {
        "code": {
          "$ref": "#/definitions/CacheEvictionErrorCode",
          "description": "Error code to match type of cache eviction error encountered."
        },
        "message": {
          "type": "string",
          "description": "More detailed error message explaining the reason for the cache eviction failure."
        },
        "node_execution_id": {
          "$ref": "#/definitions/coreNodeExecutionIdentifier",
          "description": "ID of the node execution the cache eviction failed for."
        },
        "task_execution_id": {
          "$ref": "#/definitions/coreTaskExecutionIdentifier",
          "description": "ID of the task execution the cache eviction failed for (if the node execution was part of a task execution)."
        },
        "workflow_execution_id": {
          "$ref": "#/definitions/coreWorkflowExecutionIdentifier",
          "description": "ID of the workflow execution the cache eviction failed for (if the node execution was part of a workflow execution)."
        }
      },
      "description": "Error returned if eviction of cached output fails and should be re-tried by the user."
    },
    "coreCacheEvictionErrorList": {
      "type": "object",
      "properties": {
        "errors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/coreCacheEvictionError"
          }
        }
      },
      "description": "List of :ref:`ref_flyteidl.core.CacheEvictionError` encountered during a cache eviction request."
    },
    "coreIdentifier": {
      "type": "object",
      "properties": {
        "resource_type": {
          "$ref": "#/definitions/coreResourceType",
          "description": "Identifies the specific type of resource that this identifier corresponds to."
        },
        "project": {
          "type": "string",
          "description": "Name of the project the resource belongs to."
        },
        "domain": {
          "type": "string",
          "description": "Name of the domain the resource belongs to.\nA domain can be considered as a subset within a specific project."
        },
        "name": {
          "type": "string",
          "description": "User provided value for the resource."
        },
        "version": {
          "type": "string",
          "description": "Specific version of the resource."
        }
      },
      "description": "Encapsulation of fields that uniquely identifies a Flyte resource."
    },
    "coreNodeExecutionIdentifier": {
      "type": "object",
      "properties": {
        "node_id": {
          "type": "string"
        },
        "execution_id": {
          "$ref": "#/definitions/coreWorkflowExecutionIdentifier"
        }
      },
      "description": "Encapsulation of fields that identify a Flyte node execution entity."
    },
    "coreResourceType": {
      "type": "string",
      "enum": [
        "UNSPECIFIED",
        "TASK",
        "WORKFLOW",
        "LAUNCH_PLAN",
        "DATASET"
      ],
      "default": "UNSPECIFIED",
      "description": "Indicates a resource type within Flyte.\n\n - DATASET: A dataset represents an entity modeled in Flyte DataCatalog. A Dataset is also a versioned entity and can be a compilation of multiple individual objects.\nEventually all Catalog objects should be modeled similar to Flyte Objects. The Dataset entities makes it possible for the UI  and CLI to act on the objects \nin a similar manner to other Flyte objects"
    },
    "coreTaskExecutionIdentifier": {
      "type": "object",
      "properties": {
        "task_id": {
          "$ref": "#/definitions/coreIdentifier"
        },
        "node_execution_id": {
          "$ref": "#/definitions/coreNodeExecutionIdentifier"
        },
        "retry_attempt": {
          "type": "integer",
          "format": "int64"
        }
      },
      "description": "Encapsulation of fields that identify a Flyte task execution entity."
    },
    "coreWorkflowExecutionIdentifier": {
      "type": "object",
      "properties": {
        "project": {
          "type": "string",
          "description": "Name of the project the resource belongs to."
        },
        "domain": {
          "type": "string",
          "description": "Name of the domain the resource belongs to.\nA domain can be considered as a subset within a specific project."
        },
        "name": {
          "type": "string",
          "description": "User or system provided value for the resource."
        }
      },
      "title": "Encapsulation of fields that uniquely identifies a Flyte workflow execution"
    },
    "serviceEvictCacheResponse": {
      "type": "object",
      "properties": {
        "errors": {
          "$ref": "#/definitions/coreCacheEvictionErrorList",
          "description": "List of errors encountered during cache eviction (if any)."
        }
      }
    }
  }
}
